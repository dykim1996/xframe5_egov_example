/* 2019-05-16 */ function XF_POPFIELD(a,b){this._init(a,b),_xfx.islistviewtemplate(this,b)||(this._prop(b),this._box(),this.xf_prop.create_mode==_XFD_CREATEMODE_GRID&&this._create())}XF_POPFIELD.prototype._init=function(a,b){_xfx.init(this,a,XFD_OBJKIND_CONTROL,XFD_CTRLKIND_POPFIELD,b),this.css_dom_arr=[],this.data_type=XFD_DATA_ALPHANUM,this.is_edit_cancel=!1,this.is_hangul_keydown=!1,this.value="",this.fmt_value_buffer=[],this.value_on_focus="",this.xf_edit=null,this.xf_button=null,this.pattern_type=XFD_PATTERN_TYPE_NONE,this.xf_regexp=null},XF_POPFIELD.prototype._prop=function(a){this.xf_prop={style:"",font:["굴림체",9,0,0,0,0],fore_color:[0,0,0],disable_fore_color:[0,0,0],back_color:[255,255,255],back_color_opacity:10,transparent:!1,border:1,border_radius:"0",border_color:[180,180,180],border_ex:"",button_hidden:!1,button_size:17,button_image:"",apply_inputtypecolor:!0,resize_dir:0,max_length:30,min_length:0,meta_maxlength:0,pattern:"",pattern_mask:"",pattern_front_symbol:"",pattern_rear_symbol:"",horz_align:0,vert_align:1,text_margin:[1,1,1,1],dup_name:"",allow_dup:!1,auto_dup:!1,auto_skip:!0,input_type:0,enable:!0,editable:!0,hidden:!1,default_value:"",default_value_usage:0,tabstop:!0,tooltip:"",hint_text:"",on_popfieldclick:null},this.event_name_arr=["on_prekeydown","on_keydown","on_change","on_focusout","on_focusin","on_buttonclick","on_rclick","on_dblclick","on_validation","on_changed"],_xfx.propcommon(this,this.xf_prop),_xfx.propparam(this,this.xf_prop,a),_xfx.xdataset(this,!0),this._css(a),this._css_dom(a),this._pattern(),this._patternmask()},XF_POPFIELD.prototype._pattern=function(){this.pattern_type=XFD_PATTERN_TYPE_NONE,this.xf_regexp=null,this.xf_prop.pattern.length>0&&(this.pattern_type=XFD_PATTERN_TYPE_CUSTOM,this.xf_regexp=_xfp.regexp(this.xf_prop.pattern,XFD_DATA_ALPHANUM))},XF_POPFIELD.prototype._patternmask=function(){this.mask_range_arr=_xfp.mask_range(this.xf_prop.pattern_mask),this.mask_range_count=this.mask_range_arr.length},XF_POPFIELD.prototype._css=function(a){1!=_xf_htmlready_mode&&_xfx.propcss(this,a,this.css_arr,["position","fore_color","border_radius","hidden"])},XF_POPFIELD.prototype._css_dom=function(a){1!=_xf_htmlready_mode&&(_xfx.propcss(this,a,this.css_dom_arr,["font","mouse_cursor","border_radius","horz_align","vert_align","text_margin","button_size"]),_xfx.propbackcolor(this,a,this.css_dom_arr),_xfx.bordercss(this,a,this.css_dom_arr))},XF_POPFIELD.prototype._box=function(){var a;0==_xf_htmlready_mode&&(a=[],a.push("<div"),a.push(' id="'+this.xf_prop.internal_name+'"'),a.push(' class="'+_xfx.propclass(this,this.xf_prop,"_xf_popfield")+'"'),this.xf_prop.tooltip.length>0&&a.push(' title="'+this.xf_prop.tooltip+'"'),a.push(' style="'),a.push(this.css_arr.join("")),_xfx.sizeposcss(this,this.xf_prop,a),a.push('">'),a.push('<input type="text" class="_xf_popfield_edit _xfd_padding_input"'),this.xf_prop.editable===!1&&a.push(' readonly="true"'),this.xf_prop.enable===!1&&a.push(" disabled"),this.xf_prop.hint_text.length>0&&a.push(' placeholder="'+this.xf_prop.hint_text+'"'),a.push(' maxlength="'+this._getinputmaxlength()+'"'),a.push(' style="'),a.push(this.css_dom_arr.join("")),this.xf_prop.button_hidden===!1&&(0==this.xf_prop.button_size?a.push("padding-right:"+_xfu.px(this.xf_prop.text_margin[1])+";"):a.push("padding-right:"+_xfu.px(this.xf_prop.button_size+this.xf_prop.text_margin[1]-1))),a.push('"/>'),a.push("<button"),a.push(' tabindex="-1"'),a.push(' class="_xf_popfield_button"'),this.xf_prop.enable===!1&&a.push(" disabled"),a.push(' style="'),a.push("width:"+_xfu.px(this.xf_prop.button_size)+";"),this.xf_prop.button_hidden===!0&&a.push("display:none;"),""!==this.xf_prop.button_image&&a.push("background-image:"+_xfx.imageurlfunc(this.xf_prop.button_image)),a.push('"></button>'),a.push("</div>")),_xfx.register(this,!1,a)},XF_POPFIELD.prototype._dom=function(){this.xf_edit=this.xf_object.find("._xf_popfield_edit"),this.xf_button=this.xf_object.find("._xf_popfield_button")},XF_POPFIELD.prototype._offevent=function(){_xfj.offevent(this.xf_edit,["blur","focus","copy","cut","keydown","keyup","mousedown","click","dblclick"]),_xfj.offevent(this.xf_button,["mousedown","click"])},XF_POPFIELD.prototype._event=function(){this.xf_object.on("contextmenu",$.proxy(this.on_object_rclick,this)),this.xf_edit.on("blur",$.proxy(this.on_input_blur,this)),this.xf_edit.on("dblclick",$.proxy(this.on_input_dblclick,this)),this.xf_edit.on("mousedown",$.proxy(this.on_input_mousedown,this)),this.xf_edit.on("focus",$.proxy(this.on_input_focus,this)),this.xf_edit.on("copy",$.proxy(this.on_input_copy,this)),this.xf_edit.on("cut",$.proxy(this.on_input_cut,this)),this.xf_edit.on("keydown",$.proxy(this.on_edit_keydown,this)),this.xf_edit.on("keyup",$.proxy(this.on_input_keyup,this)),this.xf_edit.on("click",$.proxy(this.on_edit_click,this)),this.xf_button.on("mousedown",$.proxy(this.on_button_mousedown,this)),this.xf_button.on("click",$.proxy(this.on_button_click,this))},XF_POPFIELD.prototype._create=function(){this._input_create()},XF_POPFIELD.prototype._firebuttonclickevent=function(a){this.xf_prop.create_mode==_XFD_CREATEMODE_GRID&&this.xf_prop.on_popbtnclick?factory._fireevent({xf_component:this.xf_prop.xf_grid,event_name:"on_popfieldclick"},this):factory._fireevent({xf_component:this,event_name:"on_buttonclick"},this)},XF_POPFIELD.prototype._setvalue=function(a,b){var c,d,e,f,g,h,i,j;if(void 0===b.is_fire_async&&(b.is_fire_async=!0),1==this.is_edit_cancel&&b.is_fire_editcomplete&&this.xf_prop.on_editcomplete)return void this.xf_prop.on_editcomplete(this,this.is_edit_cancel);if(j=0,b.event_type==XFD_DATA_CHANGE_BY_KEYUP&&(c=_xfj.position(this.xf_edit.get(0)),j=_xfj.selectcount(this.xf_edit.get(0))),b.event_type!=XFD_DATA_CHANGE_BY_API&&b.event_type!=XFD_DATA_CHANGE_BY_XDATASET||(this.value_on_focus=this.value),g=!1,d=this.xf_edit.val(),a=_xfu.str(a),0==a.length?(e="",f="",this.fmt_value_buffer=[]):(f=this._unfmt(a),this.pattern_type==XFD_PATTERN_TYPE_NONE?e=f:this.pattern_type==XFD_PATTERN_TYPE_CUSTOM?e=_xfp.exp(f,this.xf_regexp):this.pattern_type==XFD_PATTERN_TYPE_DATE&&(e=_xfp.date(f,this.xf_prop.pattern)),this.fmt_value_buffer=e.split(""),this.mask_range_count>0&&(e=_xfp.masks(e,this.mask_range_arr))),e.length>0&&(this.xf_prop.pattern_front_symbol.length>0||this.xf_prop.pattern_rear_symbol.length>0)&&(e=this.xf_prop.pattern_front_symbol+e+this.xf_prop.pattern_rear_symbol,this.xf_prop.pattern_front_symbol.length>0&&this.fmt_value_buffer.splice(0,0,this.xf_prop.pattern_front_symbol),this.xf_prop.pattern_rear_symbol.length>0&&this.fmt_value_buffer.push(this.xf_prop.pattern_rear_symbol)),d!=e&&(g=!0,this.xf_edit.val(e)),f!=this.value&&(this.value=f,1==b.is_set_xdataset&&this._setxdatasetvalue(this.value),b.is_fire_event&&(factory._fireevent({xf_component:this,event_name:"on_change",is_fire_async:b.is_fire_async},this),b.event_type!=XFD_DATA_CHANGE_BY_API&&b.event_type!=XFD_DATA_CHANGE_BY_XDATASET||factory._fireevent({xf_component:this,event_name:"on_changed"},this,this.value_on_focus,this.value))),b.event_type==XFD_DATA_CHANGE_BY_KEYUP&&1==g&&(void 0!==b.cursor_pos?c=b.cursor_pos:d.length>=e.length?j>0&&(c+=1,this.paste_value_length>0&&(c+=this.paste_value_length-1)):c+=e.length-d.length,_xfj.position(this.xf_edit.get(0),c)),b.is_set_focus&&this.setfocus(),b.event_type==XFD_DATA_CHANGE_BY_BLUR){if(0==this.value.length&&1==this.xf_prop.input_type)return factory._callbackvalidationalert(this,{component_value:"",alert_title:"검증",alert_message:"필수 항목입니다!",valid_type:"required",use_alertbox:!0}),!1;if(this.value.length>0&&(this.value.length<this.xf_prop.min_length||this.value.length>this.xf_prop.max_length))return i=[],i.push("유효하지 않은 값입니다!"),i.push("유효 길이 범위: "+this.xf_prop.min_length+" ~ "+this.xf_prop.max_length),factory._callbackvalidationalert(this,{component_value:this.value,alert_title:"검증",alert_message:i.join("\n"),valid_type:this.value.length<this.xf_prop.min_length?"length_min":"length_max",min_length:this.xf_prop.min_length,max_length:this.xf_prop.max_length,use_alertbox:!0}),!1;if(h=factory._fireevent({xf_component:this,event_name:"on_validation"},this),0==h)return!1;this.xf_prop.create_mode!=_XFD_CREATEMODE_GRID&&factory._setdupdata(this,this.value),b.is_fire_event&&this.value_on_focus!=this.value&&factory._fireevent({xf_component:this,event_name:"on_changed"},this,this.value_on_focus,this.value),factory._fireevent({xf_component:this,event_name:"on_focusout"},this)}b.is_fire_editcomplete&&this.xf_prop.on_editcomplete&&this.xf_prop.on_editcomplete(this,this.is_edit_cancel),_xfx.autoskip(this,b.event_type)},XF_POPFIELD.prototype._deleteselectdata=function(){var a,b;return a=_xfj.select(this.xf_edit.get(0)),b=a.end-a.start,b>0&&this.fmt_value_buffer.splice(a.start,b),a.start},XF_POPFIELD.prototype._iskeydelete=function(a){var b,c,d,e,f,g;return a.which!==XFD_KEY_BACKSPACE&&a.which!==XFD_KEY_DELETE?-1:(c=_xfj.select(this.xf_object.get(0)),b=c.start,d=c.end-c.start,d>0?(this.fmt_value_buffer.splice(c.start,d),c.start):(f=a.which==XFD_KEY_DELETE?this.fmt_value_buffer[b]:this.fmt_value_buffer[b-1],g=!1,null!=this.xf_regexp&&(e=$.inArray(f,this.xf_regexp.delimiter_char_arr),e>=0&&(g=!0)),a.which==XFD_KEY_DELETE?(g?this.fmt_value_buffer.splice(b,2):this.fmt_value_buffer.splice(b,1),b):g?(this.fmt_value_buffer.splice(b-2,1),b-2):(this.fmt_value_buffer.splice(b-1,1),b-1)))},XF_POPFIELD.prototype._keyprocess=function(a){var b;return factory.key_print_arr[a.which]?(b=_xfj.position(this.xf_object.get(0)),0==this._iskeynormalvalid(b,a.key)?0:(b=this._deleteselectdata(),32==a.which?this.fmt_value_buffer.splice(b,0," "):110==a.which?this.fmt_value_buffer.splice(b,0,"."):this.fmt_value_buffer.splice(b,0,a.key),1)):9},XF_POPFIELD.prototype._iskeynormalvalid=function(a,b){var c,d,e;for(c=0;;){if(d=this.xf_prop.pattern.charAt(a+c),0==d.length)return!0;if("9"==d||"A"==d)break;c++}return"A"==d?!0:"9"==d?(e=b.charCodeAt(0),e>=XFD_CHARCODE_0&&e<=XFD_CHARCODE_9):!0},XF_POPFIELD.prototype._unfmt=function(a){var b;return b=a,b=_xfx.unpatternsymbol(this,b),this.pattern_type==XFD_PATTERN_TYPE_NONE?b=b.replace(_xfp.expr_hangul,""):this.pattern_type==XFD_PATTERN_TYPE_CUSTOM?b=_xfp._exp(b,this.xf_regexp):this.pattern_type==XFD_PATTERN_TYPE_DATE&&(b=b.replace(_xfp.expr_hangul,""),b=_xfp._number(b,0,!1,factory.xf_param.VALUE_DECIMAL_SEPARATOR)),b=_xfu.trimlength(b,this.xf_prop.max_length)},XF_POPFIELD.prototype.on_object_rclick=function(a){factory.registermouseevent(this,a),a.preventDefault(),factory._fireevent({xf_component:this,event_name:"on_rclick"},this)},XF_POPFIELD.prototype.on_button_mousedown=function(a){a.preventDefault(),this.xf_prop.create_mode==_XFD_CREATEMODE_GRID&&a.stopPropagation(),0==this.is_has_focus&&(this.focused_by=1,this.xf_edit.focus())},XF_POPFIELD.prototype.on_button_click=function(a){return this.xf_prop.create_mode==_XFD_CREATEMODE_GRID&&a.stopPropagation(),2==this.xf_prop.input_type?!1:void this._firebuttonclickevent()},XF_POPFIELD.prototype.on_edit_click=function(a){return this.xf_prop.create_mode==_XFD_CREATEMODE_GRID&&a.stopPropagation(),1==this.is_has_focus&&a.stopPropagation(),2==this.xf_prop.input_type?!1:void(0==this.xf_prop.editable&&this._firebuttonclickevent())},XF_POPFIELD.prototype.on_edit_keydown=function(a){var b;if(this.xf_prop.enable){if(this.is_edit_cancel=!1,b=factory._firekeyevent(this,a,!1,"on_prekeydown"),1==b)return void a.preventDefault();if(!factory.is_mobile&&!a.ctrlKey){if(a.which==XFD_KEY_ENTER){if(0!=_xfx.iskeyfocus(a,this))return factory._firekeyevent(this,a),this.xf_prop.create_mode==_XFD_CREATEMODE_GRID&&this.xf_edit.blur(),!1}else if(0!=_xfx.iskeyfocus(a,this))return factory._firekeyevent(this,a),this.xf_prop.create_mode==_XFD_CREATEMODE_GRID&&this.xf_edit.blur(),!1;return 2==this.xf_prop.input_type?void(a.which==XFD_KEY_BACKSPACE&&a.preventDefault()):(b=this._keyprocess(a),1==b?(this._setvalue(this.fmt_value_buffer.join(""),{is_fire_event:!0,is_set_xdataset:!0,is_fire_editcomplete:!1,is_set_focus:!1,event_type:XFD_DATA_CHANGE_BY_KEYUP}),void a.preventDefault()):0==b?void a.preventDefault():(b=this._iskeydelete(a),b>=0?(this._setvalue(this.fmt_value_buffer.join(""),{is_fire_event:!0,is_set_xdataset:!0,is_fire_editcomplete:!1,is_set_focus:!1,cursor_pos:b,event_type:XFD_DATA_CHANGE_BY_KEYUP}),void a.preventDefault()):_xfx.iskeydupfield(a,this)?!1:a.which==XFD_KEY_HANGUL?(this.is_hangul_keydown=!0,!1):a.which!=XFD_KEY_ENTER&&a.which!=XFD_KEY_ESC||this.xf_prop.create_mode!=_XFD_CREATEMODE_GRID?_xfx.iskeyinputblock(a,this)?void a.preventDefault():void(_xfx.iskeyfunction(a)&&a.preventDefault()):(a.which==XFD_KEY_ESC?this.is_edit_cancel=!0:a.which==XFD_KEY_ENTER&&(this.next_focus_dir=1),this.xf_edit.blur(),!1)))}}},XF_POPFIELD.prototype.on_input_keyup=function(a){0!=this.xf_prop.enable&&2!=this.xf_prop.input_type&&((factory.is_mobile||a.which==XFD_KEY_HANGUL||this.is_hangul_keydown)&&(this.is_hangul_keydown=!1,this._setvalue(this.xf_object.val(),{is_fire_event:!0,is_set_xdataset:!0,is_fire_editcomplete:!1,is_set_focus:!1,event_type:XFD_DATA_CHANGE_BY_KEYUP})),factory._firekeyevent(this,a),a.preventDefault())},XF_POPFIELD.prototype.on_input_paste=function(a){var b,c;if(this.xf_prop.enable&&2!=this.xf_prop.input_type)return b=_xfj.eventpastevalue(a),this.paste_value_length=b.length,c=this._deleteselectdata(),this.fmt_value_buffer.splice(c,0,b),c+=this.paste_value_length,this._setvalue(this.fmt_value_buffer.join(""),{is_fire_event:!0,is_set_xdataset:!0,is_fire_editcomplete:!1,is_set_focus:!1,cursor_pos:c,event_type:XFD_DATA_CHANGE_BY_KEYUP}),this.paste_value_length=0,!1},XF_POPFIELD.prototype.on_input_blur=function(a){return this.is_has_focus=!1,0==this.xf_prop.enable?!1:void this._setvalue(this.fmt_value_buffer.join(""),{is_fire_event:!0,is_set_xdataset:!0,is_fire_editcomplete:!0,is_set_focus:!1,event_type:XFD_DATA_CHANGE_BY_BLUR,is_close_selectbox:!0,is_close_calendar:!0})},XF_POPFIELD.prototype.destroy=function(){this._offevent(),this.xf_edit.remove(),this.xf_button.remove(),this.xf_object.remove(),this.xf_xdataset._deletelinkobject(this),_xfx.unregister(this)},XF_POPFIELD.prototype.showpopup=function(){},XF_POPFIELD.prototype.setenable=function(a){this.xf_prop.enable=a,_xfj.enable(this.xf_edit,a),_xfj.enable(this.xf_button,a),a?this.xf_edit.css("color",_xfu.rgbfunc(this.xf_prop.fore_color)):this.xf_edit.css("color",_xfu.rgbfunc(this.xf_prop.disable_fore_color)),_xfc.backcolor(this.xf_edit,this.xf_prop.transparent,_xfx.inputtypebackcolor(this,this.xf_prop),this.xf_prop.back_color_opacity)},XF_POPFIELD.prototype.geteditable=function(){return this.xf_prop.editable},XF_POPFIELD.prototype.seteditable=function(a){this.xf_prop.editable=a,this.xf_edit.attr("readonly",!a)},XF_POPFIELD.prototype.getbuttonhidden=function(){return this.xf_prop.button_hidden},XF_POPFIELD.prototype.setbuttonhidden=function(a){this.xf_prop.button_hidden=a,a?(this.xf_button.css({display:"none"}),_xfc.css("padding-right",_xfu.px(this.xf_prop.text_margin[1]),!0,this.xf_edit)):(this.xf_button.css({display:"block"}),_xfc.css("padding-right",_xfu.px(this.xf_prop.button_size+this.xf_prop.text_margin[1]),!0,this.xf_edit))},XF_POPFIELD.prototype.sethorzalign=function(a){return a=_xfu["int"](a),isNaN(a)||0>a||a>2?!1:(this.xf_prop.horz_align=a,void _xfc.basic("horz_align",this.xf_prop.horz_align,!0,this.xf_edit))},XF_POPFIELD.prototype.setvertalign=function(a){return a=_xfu["int"](a),isNaN(a)||0>a||a>2?!1:(this.xf_prop.vert_align=a,void _xfc.basic("vert_align",this.xf_prop.vert_align,!0,this.xf_edit))},XF_POPFIELD.prototype.setforecolor=function(a,b,c){this.xf_prop.fore_color=_xfu.rgb(a,b,c),this.xf_edit.css("color",_xfu.rgbfunc(this.xf_prop.fore_color))},XF_POPFIELD.prototype.getbuttonimage=function(){return this.xf_prop.button_image},XF_POPFIELD.prototype.setbuttonimage=function(a){return this.xf_prop.button_image=a,0==this.xf_prop.button_image.length?_xfj.styleremove(this.xf_button,"background-image"):this.xf_button.css("background-image",_xfx.imageurlfunc(this.xf_prop.button_image)),!0};