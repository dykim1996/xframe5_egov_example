/* 2020-10-30 18:04 */ function XF_HTMLEDITOR(a,b){this._init(a,b),_xfx.islistviewtemplate(this,b)||(this._prop(b),this._box())}XF_HTMLEDITOR.EDIT_MODE_EDITOR=0,XF_HTMLEDITOR.EDIT_MODE_HTML=1,XF_HTMLEDITOR.MENUBAR_HEIGHT=22,XF_HTMLEDITOR.TOOLBAR_HEIGHT=30,XF_HTMLEDITOR.FOOTBAR_HEIGHT=26,XF_HTMLEDITOR.prototype._init=function(a,b){_xfx.init(this,a,XFD_OBJKIND_CONTROL,XFD_CTRLKIND_HTMLEDITOR,b),this.value="",this.xf_editor_window=null,this.xf_editor_document=null,this.xf_editor_body=null},XF_HTMLEDITOR.prototype._prop=function(a){this.xf_prop={font:["굴림체",9,0,0,0,0],fore_color:[0,0,0],back_color:[255,255,255],back_color_opacity:10,transparent:!1,border:1,border_color:[180,180,180],border_radius:"0",border_ex:"",padding:[10,10,10,10],resize_dir:0,boxshadow_type:0,hidden:!1,editable:!0,html_url:"",menubar_show:!0,toolbar_show:!0,footbar_show:!0},this.event_name_arr=["on_click"],_xfx.propcommon(this,this.xf_prop),_xfx.propparam(this,this.xf_prop,a),this._css(a)},XF_HTMLEDITOR.prototype._css=function(a){1!=_xf_htmlready_mode&&(_xfx.propcss(this,a,this.css_arr,["position","fore_color","font","hidden","border_radius"]),_xfx.propbackcolor(this,a,this.css_arr),_xfx.bordercss(this,a,this.css_arr))},XF_HTMLEDITOR.prototype._box=function(){var a;0==_xf_htmlready_mode&&(a=[],a.push("<div"),a.push(' id="'+this.xf_prop.internal_name+'"'),a.push(' class="'+_xfx.propclass(this,this.xf_prop,"_xf_htmleditor")+'"'),a.push(' style="'),a.push(this.css_arr.join("")),_xfx.sizeposcss(this,this.xf_prop,a),0==this.xf_prop.menubar_show&&0==this.xf_prop.toolbar_show?a.push("padding-top: 0px;"):0==this.xf_prop.menubar_show?a.push("padding-top: 30px;"):0==this.xf_prop.toolbar_show&&a.push("padding-top: 22px;"),0==this.xf_prop.footbar_show&&a.push("padding-bottom: 0px;"),a.push('">'),a.push('<div class="_xf_htmleditor_menubar" style="'),0==this.xf_prop.menubar_show&&a.push("display:none;"),0==this.xf_prop.toolbar_show&&a.push("border-bottom:1px solid rgb(230, 230, 230);"),a.push('">'),this._menubar(a),a.push("</div>"),a.push('<div class="_xf_htmleditor_toolbar" style="'),0==this.xf_prop.toolbar_show&&a.push("display:none;"),0==this.xf_prop.menubar_show&&a.push("top:0px;"),a.push('">'),this._toolbar(a),a.push("</div>"),a.push('<div class="_xf_htmleditor_content">'),a.push('<iframe class="_xf_htmleditor_content_iframe"'),this.xf_prop.html_url.length>0&&a.push(' src="'+this.xf_prop.html_url+'"'),a.push(">"),a.push("</iframe>"),a.push('<div class="_xf_htmleditor_content_html" style="display:none;"></div>'),a.push("</div>"),a.push('<div class="_xf_htmleditor_footbar" style="bottom:0px;'),0==this.xf_prop.footbar_show&&a.push("display:none;"),a.push('">'),this._footbar(a),a.push("</div>"),a.push("</div>")),_xfx.register(this,!1,a)},XF_HTMLEDITOR.prototype._menubar=function(a){a.push('<select class="_xf_htmleditor_menubar_select" data-command="formatBlock">'),a.push('<option value="- formatting -">- formatting -</option>'),a.push('<option value="<h1>">Title 1 &lt;h1&gt;</option>'),a.push('<option value="<h2>">Title 2 &lt;h2&gt;</option>'),a.push('<option value="<h3>">Title 3 &lt;h3&gt;</option>'),a.push('<option value="<h4>">Title 4 &lt;h4&gt;</option>'),a.push('<option value="<h5>">Title 5 &lt;h5&gt;</option>'),a.push('<option value="<h6>">Title 6 &lt;h6&gt;</option>'),a.push('<option value="<p>">Paragraph &lt;p&gt;</option>'),a.push('<option value="<pre>">Preformatted &lt;pre&gt;</option>'),a.push("</select>"),a.push(" "),a.push('<select class="_xf_htmleditor_menubar_select" data-command="fontName">'),a.push('<option value="- font -">- font -</option>'),a.push('<option value="Arial">Arial</option>'),a.push('<option value="Arial Black">Arial Black</option>'),a.push('<option value="Courier New">Courier New</option>'),a.push('<option value="Times New Roman">Times New Roman</option>'),a.push("</select>"),a.push(" "),a.push('<select class="_xf_htmleditor_menubar_select" data-command="fontSize">'),a.push('<option value="- size -">- size -</option>'),a.push('<option value="1">Very small</option>'),a.push('<option value="2">A bit small</option>'),a.push('<option value="3">Normal</option>'),a.push('<option value="4">Medium-large</option>'),a.push('<option value="5">Big</option>'),a.push('<option value="6">Very big</option>'),a.push('<option value="7">Maximum</option>'),a.push("</select>"),a.push(" "),a.push('<select class="_xf_htmleditor_menubar_select" data-command="foreColor">'),a.push('<option value="- color -">- color -</option>'),a.push('<option value="red">Red</option>'),a.push('<option value="blue">Blue</option>'),a.push('<option value="green">Green</option>'),a.push('<option value="white">White</option>'),a.push('<option value="black">Black</option>'),a.push("</select>"),a.push(" "),a.push('<select class="_xf_htmleditor_menubar_select" data-command="backColor">'),a.push('<option value="- background -">- background -</option>'),a.push('<option value="white">White</option>'),a.push('<option value="red">Red</option>'),a.push('<option value="green">Green</option>'),a.push('<option value="black">Black</option>'),a.push("</select>")},XF_HTMLEDITOR.prototype._toolbar=function(a){a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_clean" data-command="_cleandoc" title="Clean"></div>'),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_print" data-command="_printdoc" title="Print"></div>'),a.push(" "),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_undo" data-command="undo" title="Undo"></div>'),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_redo" data-command="redo" title="Redo"></div>'),a.push(" "),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_format" data-command="removeFormat" title="Remove formatting"></div>'),a.push(" "),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_bold" data-command="bold" title="Bold"></div>'),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_italic" data-command="italic" title="Italic"></div>'),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_underline" data-command="underline" title="Underline"></div>'),a.push(" "),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_justifyleft" data-command="justifyLeft" title="Left align"></div>'),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_justifycenter" data-command="justifyCenter" title="Center align"></div>'),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_justifyright" data-command="justifyRight" title="Right align"></div>'),a.push(" "),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_insertorderedlist" data-command="insertOrderedList" title="Numbered list"></div>'),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_insertunorderedlist" data-command="insertUnorderedList" title="Dotted list"></div>'),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_formatblock" data-command="formatBlock" data-value="blockquote" title="Quote"></div>'),a.push(" "),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_outdent" data-command="outdent" title="Delete indentation"></div>'),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_indent" data-command="indent" title="Add indentation"></div>'),a.push(" "),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_urllink" data-command="_urllink" title="Hyperlink"></div>'),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_imagelink" data-command="_imagelink" title="ImageLink"></div>'),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_imagedata" data-command="_imagedata" title="LocalImage"></div>'),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_table" data-command="_table" title="Table"></div>'),a.push(" "),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_cut" data-command="cut" title="Cut"></div>'),a.push('<div class="_xf_htmleditor_toolbar_btn _xf_htmleditor_toolbar_btn_copy" data-command="copy" title="Copy"></div>')},XF_HTMLEDITOR.prototype._footbar=function(a){var b;b=this.xf_prop.internal_name+"_checkbox",a.push('<input type="checkbox" class="_xf_edittor_footbar_checkbox" id="'+b+'">'),a.push('<label for="'+b+'" style="cursor:pointer;">HTML</label>')},XF_HTMLEDITOR.prototype._dom=function(){this.xf_menubar=this.xf_object.find("._xf_htmleditor_menubar"),this.xf_toolbar=this.xf_object.find("._xf_htmleditor_toolbar"),this.xf_content=this.xf_object.find("._xf_htmleditor_content"),this.xf_content_iframe=this.xf_content.find("._xf_htmleditor_content_iframe"),this.xf_content_html=this.xf_content.find("._xf_htmleditor_content_html"),this.xf_footbar=this.xf_object.find("._xf_htmleditor_footbar"),this.xf_editmode=this.xf_footbar.find("input"),0==this.xf_prop.html_url.length&&this._editorhtml()},XF_HTMLEDITOR.prototype._offevent=function(){_xfj.offevent(this.xf_content_iframe,["load"]),_xfj.offevent(this.xf_menubar,["change"]),_xfj.offevent(this.xf_toolbar,["click","mousedown"]),_xfj.offevent(this.xf_editmode,["change","mousedown"])},XF_HTMLEDITOR.prototype._event=function(){this.xf_content_iframe.on("load",$.proxy(this.on_iframe_load,this)),this.xf_menubar.on("change",$.proxy(this.on_menubar_change,this)),this.xf_toolbar.on("click",$.proxy(this.on_toolbar_click,this)),this.xf_toolbar.on("mousedown",$.proxy(this.on_toolbar_mousedown,this)),this.xf_editmode.on("change",$.proxy(this.on_editmode_change,this)),this.xf_editmode.on("mousedown",$.proxy(this.on_toolbar_mousedown,this))},XF_HTMLEDITOR.prototype._create=function(){this._dom(),this._event()},XF_HTMLEDITOR.prototype.on_editmode_change=function(a){this.xf_editmode[0].checked?this.seteditmode(XF_HTMLEDITOR.EDIT_MODE_HTML):this.seteditmode(XF_HTMLEDITOR.EDIT_MODE_EDITOR)},XF_HTMLEDITOR.prototype.on_menubar_change=function(a){var b,c,d;b=$(a.target),0!=b.hasClass("_xf_htmleditor_menubar_select")&&(b[0].selectedIndex<1||(c=b.data("command"),d=b[0].value,void 0!==d&&0!=d.length||(d=null),this._formatdoc(c,d),b[0].selectedIndex=0))},XF_HTMLEDITOR.prototype.on_toolbar_mousedown=function(a){a.preventDefault()},XF_HTMLEDITOR.prototype.on_toolbar_click=function(a){var b,c,d;if(b=$(a.target),0!=b.hasClass("_xf_htmleditor_toolbar_btn"))switch(c=b.data("command"),d=b.data("value"),void 0!==d&&0!=d.length||(d=null),c){case"_printdoc":this._printdoc();break;case"_cleandoc":this._cleandoc();break;case"_urllink":this._urllink();break;case"_imagelink":this._imagelink();break;case"_imagedata":this._imagedata();break;case"_table":this._inserttable();break;default:this._formatdoc(c,d)}},XF_HTMLEDITOR.prototype.on_imagefile_change=function(a){var b,c,d;return"undefined"==typeof FileReader?void alert("This browser does not support HTML5."):(b=this.xf_image_file.val(),void(0!=b.length&&(this.image_filename=this.xf_image_file[0].files[0].name,d=new FileReader,c=$(d),c.on("load",$.proxy(this.on_imagefile_data,this)),d.readAsDataURL(this.xf_image_file[0].files[0]))))},XF_HTMLEDITOR.prototype.on_imagefile_data=function(a){var b;b=this.xf_editor_document[0].createElement("IMG"),b.src=a.target.result,b.alt=this.image_filename,b.title=this.image_filename,void 0!==this.xf_image_file&&null!=this.xf_image_file&&this.xf_image_file.val(""),this._insertnodeatcursor(b)},XF_HTMLEDITOR.prototype.on_iframe_load=function(a){this.xf_prop.html_url.length>0&&this._editordom()},XF_HTMLEDITOR.prototype._editorhtml=function(){var a,b,c;a=[],a.push("<!doctype html>"),a.push("<html>"),a.push("<head>"),a.push('<meta charset="utf-8">'),a.push('<meta http-equiv="cache-control" content="no-cache">'),a.push('<meta http-equiv="pragma" content="no-cache">'),a.push('<meta name="viewport" content="width=device-width, initial-scale=1">'),a.push("<style>"),a.push("body {"),a.push("    width: auto;"),a.push("    height: auto;"),a.push("    margin: 10px;"),a.push("    line-height: 1.2;"),a.push("    ime-mode: active;"),a.push("    overflow: auto;"),a.push("}"),a.push("div,p,ol {"),a.push("    margin: 0px auto;"),a.push("    white-space: -moz-pre-wrap;"),a.push("    white-space: pre-wrap;"),a.push("    white-space: -o-pre-wrap;"),a.push("    word-break: break-all;"),a.push("}"),a.push("table {"),a.push("    border-collapse: collapse;"),a.push("    border-spacing: 0;"),a.push("}"),a.push("td {"),a.push("    border: 1px solid rgb(180,180,180);"),a.push("}"),a.push("</style>"),a.push("</head>"),a.push('<body contenteditable="true"></body>'),a.push("</html>"),b=this.xf_content_iframe[0].contentWindow,c=b.document,c.open(),c.write(a.join("")),c.close(),this._editordom()},XF_HTMLEDITOR.prototype._editordom=function(){var a,b;a=this.xf_content_iframe[0].contentWindow,b=a.document,this.xf_editor_window=$(a),this.xf_editor_document=$(a.document),this.xf_editor_body=$(b.body),this.xf_editor_body.css({"font-family":this.xf_prop.font[0],"font-size":_xfu.pt(this.xf_prop.font[1])}),this.xf_editor_body[0].innerHTML=this.value,this.seteditable(this.xf_prop.editable)},XF_HTMLEDITOR.prototype._extracttext=function(){return this.xf_content_html&&this.xf_content_html[0].innerText?this.xf_content_html[0].innerText:""},XF_HTMLEDITOR.prototype._extracthtml=function(){return this.xf_editor_body?this.xf_editor_body[0].innerHTML:""},XF_HTMLEDITOR.prototype._formatdoc=function(a,b){var c;return this.xf_editmode[0].checked?!1:(c=this.xf_editor_document[0].execCommand(a,!1,b),this.xf_editor_body[0].focus(),c)},XF_HTMLEDITOR.prototype._printdoc=function(){var a;a=window.open("","_blank","width=450,height=470,left=400,top=100,menubar=yes,toolbar=no,location=no,scrollbars=yes"),a.document.open(),a.document.write("<!doctype html><html><head><title>Print</title></head>"),a.document.write('<body onload="print();">'),a.document.write(this._extracthtml()),a.document.write("</body></html>"),a.document.close()},XF_HTMLEDITOR.prototype._cleandoc=function(){confirm("Are you sure?")&&(this.xf_editor_body[0].innerHTML="")},XF_HTMLEDITOR.prototype._urllink=function(){var a;a=prompt("Write the URL here","http://"),a&&"http://"!==a&&this._formatdoc("createLink",a)},XF_HTMLEDITOR.prototype._imagelink=function(){var a,b;b=prompt("Write the image src here","http://"),b&&"http://"!==b&&(a='<img src="'+b+'" align="middle" alt="" style="vertical-align:middle;"/>',this._inserthtmlatcursor(a))},XF_HTMLEDITOR.prototype._imagedata=function(){void 0===this.xf_image_file&&(this.xf_image_file=$('<input type="file" accept="image/*" capture="camera" style="display:none;">'),this.xf_object.append(this.xf_image_file),this.xf_image_file.on("change",$.proxy(this.on_imagefile_change,this))),this.xf_image_file[0].click()},XF_HTMLEDITOR.prototype._readimagefile=function(a){var b,c;return"undefined"==typeof FileReader?void alert("This browser does not support HTML5."):(c=new FileReader,b=$(c),b.on("load",$.proxy(this.on_imagefile_data,this)),void c.readAsDataURL(a))},XF_HTMLEDITOR.prototype._inserttable=function(){var a,b,c,d,e,f,g,h,i,j;if(b=prompt("column width (comma-separated)",""),!b&&0==b.length)return!1;if(j=b.split(","),h=j.length,c=prompt("row count, row height(comma-separated)","5,30"),(c||0!=c.length)&&(d=c.split(","),2==d.length)){if(e=_xfu.intval(d[0],1,XFD_MAX_VALUE),g=_xfu.intval(d[1],10,XFD_MAX_VALUE),e===!1||g===!1)return!1;for(a=[],a.push('<table style="border-collapse:collapse;">'),a.push("<colgroup>"),i=0;h>i;i++)a.push('<col style="width:'+j[i]+'px;">');for(a.push("</colgroup>"),a.push("<tbody>"),f=0;e>f;f++){for(a.push('<tr style="height:'+g+'px;">'),i=0;h>i;i++)a.push('<td style="border:1px solid lightgrey;"></td>');a.push("</tr>")}a.push("</tbody>"),a.push("</table>"),this._inserthtmlatcursor(a.join(""))}},XF_HTMLEDITOR.prototype._insertnodeatcursor=function(a){var b,c,d;window.getSelection&&window.getSelection().getRangeAt?(b=this.xf_editor_window[0].getSelection(),b.rangeCount>0&&(c=b.getRangeAt(0),c.insertNode(a))):document.selection&&document.selection.createRange&&(c=this.xf_editor_document[0].selection.createRange(),d=3==node.nodeType?a.data:a.outerHTML,c.pasteHTML(d))},XF_HTMLEDITOR.prototype._inserthtmlatcursor=function(a){var b,c,d;window.getSelection&&window.getSelection().getRangeAt?(b=this.xf_editor_window[0].getSelection(),b.rangeCount>0&&(c=b.getRangeAt(0),d=c.createContextualFragment(a),c.insertNode(d))):document.selection&&document.selection.createRange&&this.xf_editor_document[0].selection.createRange().pasteHTML(a)},XF_HTMLEDITOR.prototype.gettext=function(){return this.xf_editor_window&&(this.value=this._extracthtml()),this.value},XF_HTMLEDITOR.prototype.settext=function(a){this.value=a,this.xf_editor_window&&(this.xf_editor_body[0].innerHTML=a)},XF_HTMLEDITOR.prototype.geteditable=function(){return this.xf_prop.editable},XF_HTMLEDITOR.prototype.seteditable=function(a){return this.xf_prop.editable=a,this.xf_editor_body&&(1==this.xf_prop.editable?(this.xf_editor_document[0].designMode="On",this.xf_editor_body[0].contentEditable=!0):(this.xf_editor_document[0].designMode="Off",this.xf_editor_body[0].contentEditable=!1)),!0},XF_HTMLEDITOR.prototype.getmenubarshow=function(){return this.xf_prop.menubar_show},XF_HTMLEDITOR.prototype.setmenubarshow=function(a){return this.xf_prop.menubar_show=a,a?this.xf_menubar.show():this.xf_menubar.hide(),this._toolbarpossize(),!0},XF_HTMLEDITOR.prototype.gettoolbarshow=function(){return this.xf_prop.toolbar_show},XF_HTMLEDITOR.prototype.settoolbarshow=function(a){return this.xf_prop.toolbar_show=a,a?this.xf_toolbar.show():this.xf_toolbar.hide(),this._toolbarpossize(),!0},XF_HTMLEDITOR.prototype.getfootbarshow=function(){return this.xf_prop.footbar_show},XF_HTMLEDITOR.prototype.setfootbarshow=function(a){return this.xf_prop.footbar_show=a,a?this.xf_footbar.show():this.xf_footbar.hide(),this._toolbarpossize(),!0},XF_HTMLEDITOR.prototype._toolbarpossize=function(){var a,b;a=0,this.xf_prop.menubar_show&&(a+=XF_HTMLEDITOR.MENUBAR_HEIGHT),this.xf_prop.toolbar_show&&(0==this.xf_prop.menubar_show?this.xf_toolbar.css("top","0px"):this.xf_toolbar.css("top",_xfu.px(XF_HTMLEDITOR.MENUBAR_HEIGHT)),a+=XF_HTMLEDITOR.TOOLBAR_HEIGHT),b=0,this.xf_prop.footbar_show&&(b=XF_HTMLEDITOR.FOOTBAR_HEIGHT),this.xf_object.css({paddingTop:_xfu.px(a),paddingBottom:_xfu.px(b)})},XF_HTMLEDITOR.prototype.geteditmode=function(){return this.xf_editmode[0].checked?XF_HTMLEDITOR.EDIT_MODE_HTML:XF_HTMLEDITOR.EDIT_MODE_EDITOR},XF_HTMLEDITOR.prototype.seteditmode=function(a){var b;return a=_xfu.intval(a,XF_HTMLEDITOR.EDIT_MODE_EDITOR,XF_HTMLEDITOR.EDIT_MODE_HTML),a===!1?!1:(a==XF_HTMLEDITOR.EDIT_MODE_HTML?(b=[],this.xf_editmode[0].checked=!0,this.xf_content_html[0].contentEditable=!0,b.push(this._extracthtml()),this.xf_content_html[0].innerText=b.join(""),this.xf_content_iframe.hide(),this.xf_content_html.show(),this.xf_content_html.focus(),this.xf_object.css("padding-top","0px"),this.xf_menubar.hide(),this.xf_toolbar.hide()):(this.xf_editmode[0].checked=!1,this.xf_editor_body[0].innerHTML=this._extracttext(),this.xf_content_html.hide(),this.xf_content_iframe.show(),this.xf_content_iframe.focus(),this.xf_object.css("padding-top","50px"),this.xf_menubar.show(),this.xf_toolbar.show()),!0)};