/* 2020-10-30 18:04 */ function XF_FILE(a,b){this._init(a,b),this._prop(b),this._box()}XF_FILE.FILE_SELECT_FILES=0,XF_FILE.FILE_READ_AS_TEXT=1,XF_FILE.FILE_READ_AS_DATAURL=2,XF_FILE.prototype._init=function(a,b){_xfx.init(this,a,XFD_OBJKIND_CONTROL,XFD_CTRLKIND_FILE,b),this.css_arr=[],this.text_encoding="",this.is_support_filereader=!0,"undefined"==typeof FileReader&&(this.is_support_filereader=!1),this.event_type=XF_FILE.FILE_SELECT_FILES},XF_FILE.prototype._prop=function(a){this.xf_prop={hidden:!0,tabstop:!1,enable:!0},this.event_name_arr=["on_selectfiles","on_readastext","on_readasdataurl"],_xfx.propcommon(this,this.xf_prop),_xfx.propparam(this,this.xf_prop,a),this._css(a)},XF_FILE.prototype._css=function(a){1!=_xf_htmlready_mode&&_xfx.propcss(this,a,this.css_arr,["position","hidden"])},XF_FILE.prototype._box=function(){var a;0==_xf_htmlready_mode&&(a=[],a.push("<div"),a.push(' id="'+this.xf_prop.internal_name+'"'),a.push(' class="'+_xfx.propclass(this,this.xf_prop,"_xf_file")+'"'),a.push(' style="'),a.push(this.css_arr.join("")),_xfx.sizeposcss(this,this.xf_prop,a),a.push('">'),a.push('<input type="file" class="_xf_file_input" />'),a.push("</div>")),_xfx.register(this,!1,a)},XF_FILE.prototype._dom=function(){this.xf_file=this.xf_object.find("._xf_file_input")},XF_FILE.prototype._offevent=function(){_xfj.offevent(this.xf_file,["change"])},XF_FILE.prototype._event=function(){this.xf_file.on("change",$.proxy(this.on_change,this))},XF_FILE.prototype._create=function(){this._dom(),this._event(),factory._fireevent({xf_component:this,event_name:"on_create"},this)},XF_FILE.prototype._readastextbyfile=function(a,b){var c,d;return c=this,d=new FileReader,d.readAsText(a,b),d.onload=function(){factory._fireevent({xf_component:c,event_name:"on_readastext"},c,d.result)},!0},XF_FILE.prototype._readasdataurlbyfile=function(a){var b,c,d,e,f;return b=this,c=new FileReader,c.readAsDataURL(a),c.onload=function(){d=c.result,"data"==d.substr(0,4)?(e=d.indexOf(","),f=-1==e?d:d.substr(e+1)):f=d,factory._fireevent({xf_component:b,event_name:"on_readasdataurl"},b,f)},!0},XF_FILE.prototype.selectfiles=function(a,b){void 0===a&&(a="*"),void 0===b&&(b=!0),this.xf_file[0].value="",this.xf_file.attr("accept",a),1==b?this.xf_file.attr("multiple",""):this.xf_file.removeAttr("multiple"),this.event_type=XF_FILE.FILE_SELECT_FILES,this.xf_file.click()},XF_FILE.prototype.readastext=function(a,b){return 0==this.is_support_filereader?!1:(void 0===b&&(b=""),a instanceof File==!0?this._readastextbyfile(a,b):(this.xf_file[0].value="",this.text_encoding=b,this.xf_file.attr("accept","text/plain"),this.xf_file.removeAttr("multiple"),this.event_type=XF_FILE.FILE_READ_AS_TEXT,this.xf_file.click(),!0))},XF_FILE.prototype.readasdataurl=function(a,b){return 0==this.is_support_filereader?!1:(void 0===b&&(b="*"),a instanceof File==!0?this._readasdataurlbyfile(a):(this.xf_file[0].value="",this.xf_file.attr("accept",b),this.xf_file.removeAttr("multiple"),this.event_type=XF_FILE.FILE_READ_AS_DATAURL,this.xf_file.click(),!0))},XF_FILE.prototype.getfilecount=function(){return this.xf_file[0].files.length},XF_FILE.prototype.getfileobj=function(a){return 0==this.xf_file[0].files.length?null:(a=_xfu.intval(a,0,this.xf_file[0].files.length),a===!1?null:this.xf_file[0].files[a])},XF_FILE.prototype.getfilesize=function(a,b){return a instanceof File==!0?a.size:0==this.xf_file[0].files.length?-1:(b=_xfu.intval(b,0,this.xf_file[0].files.length),b===!1?-1:this.xf_file[0].files[b].size)},XF_FILE.prototype.getfiletype=function(a,b){return a instanceof File==!0?a.type:0==this.xf_file[0].files.length?"":(b=_xfu.intval(b,0,this.xf_file[0].files.length),b===!1?"":this.xf_file[0].files[b].type)},XF_FILE.prototype.getfilename=function(a,b){return a instanceof File==!0?a.name:0==this.xf_file[0].files.length?"":(b=_xfu.intval(b,0,this.xf_file[0].files.length),b===!1?"":this.xf_file[0].files[b].name)},XF_FILE.prototype.on_change=function(a){0!=this.xf_file[0].files.length&&(this.event_type==XF_FILE.FILE_READ_AS_TEXT?this._readastextbyfile(this.xf_file[0].files[0],this.text_encoding):this.event_type==XF_FILE.FILE_READ_AS_DATAURL?this._readasdataurlbyfile(this.xf_file[0].files[0]):factory._fireevent({xf_component:this,event_name:"on_selectfiles"},this,this.xf_file[0].files))};