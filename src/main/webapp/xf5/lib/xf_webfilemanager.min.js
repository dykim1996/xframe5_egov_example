/* 2020-10-30 18:04 */ function XF_WEBFILEMANAGER(a,b){this._init(a,b),this._member(),this._prop(b),this._css(b),this._box()}function XF_WEBFILEMANAGER_DOWNLOAD_DLG(a,b){this._init(a),this._member(),this._prop(b),this._box(),this._dom(),this._event()}XF_WEBFILEMANAGER.prototype._init=function(a,b){this.xf_parent=a,this.control_kind=XFD_CTRLKIND_WEBFILEMANAGER,this.object_kind=XFD_OBJKIND_CONTROL},XF_WEBFILEMANAGER.prototype._member=function(){this.download_list=[],this.inner_download_list=[],this.download_seq=0,this.last_download_count=0,this.last_downfile_result=[],this.progress_dialog=null,this.is_expired=!1,this.stop_download_flag=!1,this.html_arr=[],this.css_arr=[]},XF_WEBFILEMANAGER.prototype._prop=function(a){this.xf_prop_type={control_id:XFD_PROP_INT,position:XFD_PROP_INT,x:XFD_PROP_INT,y:XFD_PROP_INT,width:XFD_PROP_INT,width_unit:XFD_PROP_INT,width_percent:XFD_PROP_INT,height:XFD_PROP_INT,height_unit:XFD_PROP_INT,height_percent:XFD_PROP_INT,margin:XFD_PROP_MARGIN,hidden:XFD_PROP_BOOL},this.xf_prop={control_id:-1,name:"",description:"",position:0,x:0,y:0,width:28,width_unit:0,width_percent:100,height:28,height_unit:0,height_percent:100,hidden:!0,margin:[0,0,0,0],on_downloadcomplete:null,internal_name:""},_xfx.prop(this,this.xf_prop,this.xf_prop_type,a)},XF_WEBFILEMANAGER.prototype._css=function(a){var b,c;for(b in a)switch(c=a[b],b){case"position":this.css_arr.push(_xfc.basic(b,c))}this.class_name=_xfx.classname(a.internal_name),$.extend(this.xf_prop,a)},XF_WEBFILEMANAGER.prototype._box=function(){var a;0==_xf_htmlready_mode&&(a=[],a.push("<div"),a.push(' id="'+this.xf_prop.internal_name+'"'),a.push(' class="_xf_webfilemanager '+this.class_name+'"'),a.push(' style="'),a.push(this.css_arr.join("")),-1==this.xf_prop.width?a.push("width:100%;height:100%;"):(0==this.xf_prop.width_unit?a.push("width:"+_xfu.px(this.xf_prop.width)+";"):1==this.xf_prop.width_unit&&a.push("width:"+_xfu.pc(this.xf_prop.width_percent)+";"),0==this.xf_prop.height_unit?a.push("height:"+_xfu.px(this.xf_prop.height)+";"):1==this.xf_prop.height_unit&&a.push("height:"+_xfu.pc(this.xf_prop.height_percent)+";")),0==this.xf_prop.position?(a.push(_xfc.basic("x",this.xf_prop.x)),a.push(_xfc.basic("y",this.xf_prop.y))):1==this.xf_prop.position&&a.push(_xfc.basic("margin",this.xf_prop.margin)),a.push('"'),a.push(">"),a.push("</button>")),_xfx.register(this,!1,a)},XF_WEBFILEMANAGER.prototype._dom=function(){this.xf_a=$("<a>"),this.xf_a.appendTo(this.xf_object),this.xf_a.hide()},XF_WEBFILEMANAGER.prototype._offevent=function(){this.xf_object.off("on_downloadcomplete")},XF_WEBFILEMANAGER.prototype._event=function(){var a=["on_downloadcomplete"];_xfx.event(this.xf_prop,a),this._offevent(),this.xf_object.on("on_downloadcomplete",$.proxy(this.on_object_downloadcomplete,this))},XF_WEBFILEMANAGER.prototype._create=function(){this._dom(),this._event()},XF_WEBFILEMANAGER.prototype._initialize_last_result=function(){this.last_downfile_result=[]},XF_WEBFILEMANAGER.prototype._encode=function(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;)b[c]=255&a.charCodeAt(c++),b[c]=255&a.charCodeAt(c++),b[c]=255&a.charCodeAt(c++);return b},XF_WEBFILEMANAGER.prototype._continue_download=function(){var a=this.download_seq++;if(a>=this.inner_download_list.length)return void(this.download_seq=0);this.progress_dialog&&this.progress_dialog._update_download_count();var b=this,c=new XMLHttpRequest;c.onreadystatechange=function(){var c=!1,d="",e=0;if(4==this.readyState){if(200==this.status){var f=b._encode(this.responseText),g=new Blob([f],{type:"application/octet-binary"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(g,b.inner_download_list[a].filename),f=null,g=null;else{var h=URL.createObjectURL(g);b.xf_a.attr("href",h),b.xf_a.attr("download",b.inner_download_list[a].filename);var i=document.createEvent("MouseEvents");i.initEvent("click",!0,!0),b.xf_a.get(0).dispatchEvent(i)}c=!0}else c=!1,e=this.status,d=this.statusText;setTimeout($.proxy(b._download_complete,b,c,e,d),100)}},c.open("GET",encodeURI(this.inner_download_list[a].url),!0),c.overrideMimeType("text/plain; charset=x-user-defined"),c.reponseType="blob",c.send()},XF_WEBFILEMANAGER.prototype._download_complete=function(a,b,c){this.last_download_count++,this.progress_dialog&&this.progress_dialog._update_download_result(a);var d=a?1:0;return this.last_downfile_result.push({filename:this.inner_download_list[this.download_seq-1].filename,result:d,url:this.inner_download_list[this.download_seq-1].url,errcode:b,errmsg:c}),this.download_seq==this.inner_download_list.length?(factory._fireevent({xf_component:this,event_name:"on_downloadcomplete"},this,1),void(this.download_seq=0)):void(this.stop_download_flag?(this.stop_download_flag=!1,factory._fireevent({xf_component:this,event_name:"on_downloadcomplete"},this,2)):this._continue_download.call(this))},XF_WEBFILEMANAGER.prototype.adddownloadlist=function(a,b){this.download_list.push({filename:a,url:b})},XF_WEBFILEMANAGER.prototype.deletealldownloadlist=function(){this.download_list=[]},XF_WEBFILEMANAGER.prototype.deletedownloadlist=function(a,b){},XF_WEBFILEMANAGER.prototype.downloadoption=function(a,b,c,d,e,f){},XF_WEBFILEMANAGER.prototype.getlastdownfilecount=function(){return this.last_download_count},XF_WEBFILEMANAGER.prototype.getlastdownfileerrorcode=function(a){return this.last_downfile_result.length>a?this.last_downfile_result[a].errcode:0},XF_WEBFILEMANAGER.prototype.getlastdownfileerrormsg=function(a){return this.last_downfile_result.length>a?this.last_downfile_result[a].errmsg:""},XF_WEBFILEMANAGER.prototype.getlastdownfilename=function(a){return this.last_downfile_result.length>a?this.last_downfile_result[a].filename:""},XF_WEBFILEMANAGER.prototype.getlastdownfilerecvinfo=function(a,b){},XF_WEBFILEMANAGER.prototype.getlastdownfileresult=function(a){return this.last_downfile_result.length>a?this.last_downfile_result[a].result:-1},XF_WEBFILEMANAGER.prototype.getlastdownfileurl=function(a){return this.last_downfile_result.length>a?this.last_downfile_result[a].url:""},XF_WEBFILEMANAGER.prototype.getlastdownloadsavedir=function(){},XF_WEBFILEMANAGER.prototype.setdownloadsavedir=function(){},XF_WEBFILEMANAGER.prototype.showdownloaddialog=function(){this.progress_dialog=new XF_WEBFILEMANAGER_DOWNLOAD_DLG(this);var a=new XF_MODALBOX({xf_screen:this.xf_parent.xf_screen,name:this.xf_prop.name+"_modal_box",title:"다운로드",url:"",xf_content:this.progress_dialog.xf_object,padding:0,width:393,height:290,is_center:!0});this.progress_dialog.xf_modalbox=a,a.show()},XF_WEBFILEMANAGER.prototype.showdownloaddialogex=function(a){},XF_WEBFILEMANAGER.prototype.stopdownload=function(){this.stop_download_flag=!0},XF_WEBFILEMANAGER.prototype.startdownload=function(){this.stop_download_flag=!1,this._initialize_last_result(),this.last_download_count=0,this.inner_download_list=this.download_list,this.progress_dialog&&(this.download_seq=0,this.progress_dialog._init_progress(),this.progress_dialog._initialize_download_status()),this._continue_download()},XF_WEBFILEMANAGER_DOWNLOAD_DLG.prototype._init=function(a){this.webfm=a},XF_WEBFILEMANAGER_DOWNLOAD_DLG.prototype._member=function(){this.xf_modalbox=null},XF_WEBFILEMANAGER_DOWNLOAD_DLG.prototype._prop=function(a){},XF_WEBFILEMANAGER_DOWNLOAD_DLG.prototype._box=function(){this.html_arr=[],this.html_arr.push("<div id='fileDownload' class='_xf_webfiledownload_dlg'>"),this.html_arr.push("<fieldset  class='_xf_webfiledownload_filelist_groupbox'>"),this.html_arr.push("<legend>다운로드 리스트</legend>"),this.html_arr.push("<table id='fileList'  class='_xf_webfiledowwload_filelist'></table>"),this.html_arr.push("</fieldset>"),this.html_arr.push("<fieldset  class='_xf_webfiledownload_progress_groupbox'>"),this.html_arr.push("<legend>다운로드 진행상황</legend>"),this.html_arr.push("<span id='progress_count' class='_xf_webfiledownload_progress_count'>0/0</span>"),this.html_arr.push("현재 "),this.html_arr.push("<progress id='current_progress' class='_xf_webfiledownload_progressbar' value='0' max='100'></progress>"),this.html_arr.push("<br>전체 "),this.html_arr.push("<progress id='total_progress' class='_xf_webfiledownload_progressbar' value='0' max='100'></progress>"),this.html_arr.push("</fieldset>"),this.html_arr.push("<button type='button' id='start_downloading' class='_xf_webfiledownload_action_button'>다운로드 시작</button>"),this.html_arr.push("<button type='button' id='stop_downloading' class='_xf_webfiledownload_action_button'>다운로드 멈춤</button>"),this.html_arr.push("<button type='button' id='close' class='_xf_webfiledownload_action_button'>닫기</button>"),this.html_arr.push("<br>"),this.html_arr.push("</div>"),this.xf_object=$(this.html_arr.join(""))},XF_WEBFILEMANAGER_DOWNLOAD_DLG.prototype._dom=function(){this.xf_file_list=this.xf_object.find("#fileList"),this.xf_file_list.empty(),this.xf_file_list.append("<tr><th class='_xf_webfiledownload_filelist_header_filename'>파일명</th><th  class='_xf_webfiledownload_filelist_header_status'>상태</th></tr>");for(var a=0;a<this.webfm.download_list.length;a++)this.xf_file_list.append("<tr><td class='_xf_webfiledownload_filelist_data_filename'>"+this.webfm.download_list[a].filename+"</td><td id='status"+(a+1)+"'class='_xf_webfiledownload_filelist_data_status'>대기</td></tr>");this.xf_current_progress=this.xf_object.find("#current_progress"),this.xf_progress_count=this.xf_object.find("#progress_count"),this.xf_total_progress=this.xf_object.find("#total_progress"),this.xf_start_button=this.xf_object.find("#start_downloading"),this.xf_stop_button=this.xf_object.find("#stop_downloading"),this.xf_close_button=this.xf_object.find("#close"),this._init_progress()},XF_WEBFILEMANAGER_DOWNLOAD_DLG.prototype._init_progress=function(){this.xf_current_progress.attr("value",0),this.xf_current_progress.attr("max",100),this.xf_total_progress.attr("value",0),this.xf_total_progress.attr("max",this.webfm.download_list.length),this.xf_progress_count.text(this.webfm.download_seq+"/"+this.webfm.download_list.length)},XF_WEBFILEMANAGER_DOWNLOAD_DLG.prototype._offevent=function(){this.xf_object.off("close"),this.xf_start_button.off("click"),this.xf_stop_button.off("click"),this.xf_close_button.off("click")},XF_WEBFILEMANAGER_DOWNLOAD_DLG.prototype._event=function(){this.xf_object.on("close",$.proxy(this._on_close,this)),this.xf_start_button.on("click",$.proxy(this._on_start_button_clicked,this)),this.xf_stop_button.on("click",$.proxy(this._on_stop_button_clicked,this)),this.xf_close_button.on("click",$.proxy(this._on_close_button_clicked,this))},XF_WEBFILEMANAGER_DOWNLOAD_DLG.prototype._initialize_download_status=function(){for(var a=0;a<this.webfm.download_list.length;a++)$("#status"+(a+1)).text("대기")},XF_WEBFILEMANAGER_DOWNLOAD_DLG.prototype._update_download_count=function(){this.xf_current_progress.attr("value",0),this.xf_progress_count.text(this.webfm.download_seq+"/"+this.webfm.download_list.length)},XF_WEBFILEMANAGER_DOWNLOAD_DLG.prototype._update_download_result=function(a){this.xf_current_progress.attr("value",100),this.xf_total_progress.attr("value",this.webfm.download_seq),$("#status"+this.webfm.download_seq).text(a?"성공":"실패")},XF_WEBFILEMANAGER_DOWNLOAD_DLG.prototype._on_start_button_clicked=function(){this.webfm.startdownload()},XF_WEBFILEMANAGER_DOWNLOAD_DLG.prototype._on_stop_button_clicked=function(){this.webfm.stopdownload()},XF_WEBFILEMANAGER_DOWNLOAD_DLG.prototype._on_close_button_clicked=function(){this.webfm.deletealldownloadlist(),this.xf_modalbox.remove()},XF_WEBFILEMANAGER_DOWNLOAD_DLG.prototype._on_close=function(){this._offevent(),this._on_close_button_clicked()},XF_WEBFILEMANAGER.prototype.on_object_downloadcomplete=function(a,b){null!=this.xf_prop.on_downloadcomplete&&window[this.xf_prop.on_downloadcomplete](this,b)};