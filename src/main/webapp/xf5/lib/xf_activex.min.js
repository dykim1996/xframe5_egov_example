/* 2020-10-30 18:04 */ function XF_ACTIVEX(a,b){this._init(a,b),this._prop(b),this._box()}XF_ACTIVEX.prototype._init=function(a,b){_xfx.init(this,a,XFD_OBJKIND_CONTROL,XFD_CTRLKIND_ACTIVEX,b),this.xf_innerctrl=null,this.innerctrl=null,this.innerctrl_name="",this.class_id="",this.activex_prop={},this.activex_event={}},XF_ACTIVEX.prototype._prop=function(a){this.xf_prop={classid:"",codebase:"",initparam:"",hidden:!1,enterstop:!0,tabstop:!0,use_tabkey:!1,fireevent_procmode:0,alert_createerror:!0,boxshadow_type:0,version:"2.0",margin:[0,0,0,0],input_type:0,create_error_message:"ActiveX Creation Error"},this.event_name_arr=[],_xfx.propcommon(this,this.xf_prop),this._prop_activex(a),_xfx.propparam(this,this.xf_prop,a),this._css(a),this.innerctrl_name=this.xf_prop.internal_name+"_innerctrl",void 0!==a.classid&&a.classid.length>0&&(this.class_id=a.classid.substr(1,a.classid.length-2))},XF_ACTIVEX.prototype._prop_activex=function(a){var b,c,d;for(b in a)c=a[b],void 0===this.xf_prop[b]&&("eventfunc"==c.substr(0,9)?(d=c.split(":"),this.activex_event[b]=d[1]):this.activex_prop[b]=c)},XF_ACTIVEX.prototype._css=function(a){1!=_xf_htmlready_mode&&_xfx.propcss(this,a,this.css_arr,["position","hidden"])},XF_ACTIVEX.prototype._box=function(){var a;0==_xf_htmlready_mode&&(a=[],a.push("<div"),a.push(' id="'+this.xf_prop.internal_name+'"'),a.push(' class="'+_xfx.propclass(this,this.xf_prop,"_xf_activex")+'"'),a.push(' style="'),a.push(this.css_arr.join("")),_xfx.sizeposcss(this,this.xf_prop,a),a.push('">'),a.push('<div class="_xf_activex_script"></div>'),a.push('<span class="_xf_activex_errormsg">'+this.xf_prop.create_error_message+"</span>"),a.push("</div>")),_xfx.register(this,!1,a)},XF_ACTIVEX.prototype._dom=function(){this.xf_error_message=this.xf_object.find("._xf_activex_errormsg"),this.xf_activex_script=this.xf_object.find("._xf_activex_script")},XF_ACTIVEX.prototype._event=function(){var a,b,c,d,e,f;for(a in this.activex_event)b=this.activex_event[a],c=b.split("("),d=c[0],e=c[1],e=e.substr(0,e.length-1),f=e.split(","),f.shift(),this.writeeventhandlerfor(a,f,b)},XF_ACTIVEX.prototype._create=function(){this._dom(),this._event(),this._activex()},XF_ACTIVEX.prototype._activex=function(){var a,b,c;a=[],a.push("<object "),a.push(' class="_xf_activex_innerctrl"'),a.push(' id="'+this.innerctrl_name+'"'),a.push(' classid="clsid:'+this.class_id+'"'),this.xf_prop.codebase.length>0&&a.push(' codebase="'+this.xf_prop.codebase+'"'),a.push(">"),a.push(this._activexinitparam()),a.push("</object>"),this.xf_innerctrl=$(a.join("")),this.innerctrl=this.xf_innerctrl.get(0),this.innerctrl._xf_parent_activex=this,this.xf_object.append(this.xf_innerctrl);for(b in this.activex_prop)c=this.activex_prop[b],this.innerctrl[b]=c},XF_ACTIVEX.prototype._activexinitparam=function(){var a,b,c,d,e;if(0==this.xf_prop.initparam.length)return"";for(b=this.xf_prop.initparam.split(";"),c=b.length,a=[],d=0;c>d;d++)e=b[d].split("="),2==e.length&&a.push('<param name="'+e[0]+'" value="'+e[1]+'">');return a.join("")},XF_ACTIVEX.prototype._activexparam=function(){var a,b,c;a=[];for(b in this.activex_prop)c=this.activex_prop[b],a.push('<param name="'+b+'" value="'+c+'">');return a.join("")},XF_ACTIVEX.prototype.writeeventhandlerfor=function(a,b,c){var d,e,f;f=c.substr(0,c.indexOf("(")),d=document.createElement("script"),d.setAttribute("for",this.innerctrl_name),d["for"]=this.innerctrl_name,d.event=a+"("+b.join(",")+")",e=[],e.push("var objInst = "+this.xf_prop.name+";"),e.push('objInst.xf_prop["'+a+'"] = "'+f+'";'),e.push('factory._fireevent({ xf_component: objInst, event_name: "'+a+'" }, '),e.push("objInst"),b.length>0&&(e.push(","),e.push(b.join(","))),e.push(");"),d.innerHTML=e.join("\n"),this.xf_activex_script[0].appendChild(d)},XF_ACTIVEX.prototype.getclassid=function(){return this.xf_prop.classid},XF_ACTIVEX.prototype.getinnerctrlname=function(){return this.xf_prop.classid};