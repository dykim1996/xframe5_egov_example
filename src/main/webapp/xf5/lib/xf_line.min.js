/* 2020-10-30 18:04 */ function XF_LINE(a,b){this._init(a,b),_xfx.islistviewtemplate(this,b)||(this._prop(b),this._box())}XF_LINE.prototype._init=function(a,b){_xfx.init(this,a,XFD_OBJKIND_SHAPE,XFD_SHAPEKIND_LINE,b)},XF_LINE.prototype._prop=function(a){this.xf_prop={x1:0,y1:0,x2:0,y2:0,style:"",line_width:0,line_style:0,line_color:[180,180,180],arrow_style:0,resize_dir:0,enable:!0,hidden:!1,click_setfocus:!1,dragable:!1},this.event_name_arr=["on_click"],_xfx.propcommon(this,this.xf_prop),_xfx.propparam(this,this.xf_prop,a),this.xf_prop.line_width=this.xf_prop.line_width+1,this._css(a)},XF_LINE.prototype._css=function(a){1!=_xf_htmlready_mode&&_xfx.propcss(this,a,this.css_arr,["position","hidden"])},XF_LINE.prototype._box=function(){var a;0==_xf_htmlready_mode&&(a=[],a.push("<canvas"),a.push(' id="'+this.xf_prop.internal_name+'"'),a.push(' class="'+_xfx.propclass(this,this.xf_prop,"_xf_line")+'"'),-1==this.xf_prop.width?a.push("width=100%;height=100%;"):(0==this.xf_prop.width_unit?a.push('width="'+this.xf_prop.width+'"'):1==this.xf_prop.width_unit&&a.push('width="'+_xfu.pc(this.xf_prop.width_percent)+';"'),0==this.xf_prop.height_unit?a.push('height="'+this.xf_prop.height+'"'):1==this.xf_prop.height_unit&&a.push("height="+_xfu.pc(this.xf_prop.height_percent)+";")),a.push(' style="'),a.push(this.css_arr.join("")),_xfx.poscss(this,this.xf_prop,a),a.push('">'),a.push("</canvas>")),_xfx.register(this,!1,a)},XF_LINE.prototype._dom=function(){this.originvalue.x1=this.xf_prop.x1,this.originvalue.y1=this.xf_prop.y1,this.originvalue.x2=this.xf_prop.x2,this.originvalue.y2=this.xf_prop.y2,this._before_drawing_arrow(this.xf_prop.x2,this.xf_prop.y2)},XF_LINE.prototype._offevent=function(){_xfj.offevent(this.xf_object,["mousedown","click"])},XF_LINE.prototype._event=function(){this.xf_object.on("mousedown",$.proxy(this.on_object_mousedown,this)),this.xf_object.on("click",$.proxy(this.on_object_click,this))},XF_LINE.prototype._create=function(){this._dom(),this._event()},XF_LINE.prototype._draw_line=function(a,b,c,d,e,f){var g,h,i,j;switch(a.beginPath(),e.x==f.x&&0!=this.xf_prop.arrow_style?(g=d.h+this.xf_prop.line_width,h=b.y,i=d.h+this.xf_prop.line_width,j=c.y):0==e.y&&0==f.y&&0!=this.xf_prop.arrow_style?(this.xf_object.css("top",-(this.xf_object.height()/2)),g=b.x,h=b.y+d.h+this.xf_prop.line_width,i=c.x,j=c.y+d.h+this.xf_prop.line_width):0==e.y&&0==f.y&&0==this.xf_prop.arrow_style?(this.xf_object.css("top",-(this.xf_object.height()/2)),g=b.x,h=b.y+this.xf_prop.line_width/2,i=c.x,j=c.y+this.xf_prop.line_width/2):0==e.x&&0==f.x&&0!=this.xf_prop.arrow_style?(this.xf_object.css("left",-(this.xf_object.width()/2)),g=b.x+d.h+this.xf_prop.line_width,h=b.y,i=c.x+d.h+this.xf_prop.line_width,j=c.y):0==e.x&&0==f.x&&0==this.xf_prop.arrow_style?(this.xf_object.css("left",-(this.xf_object.width()/2)),g=b.x+this.xf_prop.line_width/2,h=b.y,i=c.x+this.xf_prop.line_width/2,j=c.y):e.x==f.x&&0==this.xf_prop.arrow_style?(g=b.x+this.xf_prop.line_width/2,h=b.y,i=c.x+this.xf_prop.line_width/2,j=c.y):e.y==f.y&&0==this.xf_prop.arrow_style?(g=b.x,h=this.xf_prop.line_width/2,i=c.x,j=this.xf_prop.line_width/2):e.y==f.y&&0!=this.xf_prop.arrow_style?(g=b.x,h=this.xf_object.height()/2,i=c.x,j=this.xf_object.height()/2):(g=b.x,h=b.y,i=c.x,j=c.y),a.moveTo(g,h),a.lineTo(i,j),a.strokeStyle=_xfu.rgbfunc(this.xf_prop.line_color),a.lineWidth=this.xf_prop.line_width,this.xf_prop.line_style){case 0:break;case 1:a.setLineDash([10,3]);break;case 2:a.setLineDash([5,5]);break;case 3:a.setLineDash([8,8,4,8]);break;case 4:a.setLineDash([8,6,4,3,4,6])}a.stroke()},XF_LINE.prototype._before_drawing_arrow=function(a,b){var c,d,e,f,g,h,i,j,k,l,m;g={x:this.originvalue.x1,y:this.originvalue.y1},h={x:a,y:b},i={x:0,y:0},j={x:a-this.originvalue.x1,y:b-this.originvalue.y1},k={x:this.originvalue.x1-a,y:0},l={x:0,y:b-this.originvalue.y1},m={h:this.xf_prop.line_width+4,w:this.xf_prop.line_width+12},g.x-h.x>0?(c=g.x,d=h.x):(c=h.x,d=g.x),g.y-h.y>0?(e=g.y,f=h.y):(e=h.y,f=g.y),this._size(g,h,j,m,d,f,c,e),this._initanchor(),this._begin_drawing_line(g,h,k,l,a,b,i,j,m)},XF_LINE.prototype._begin_drawing_line=function(a,b,c,d,e,f,g,h,i){var j,k,l,m;if(m=this.xf_object.get(0).getContext("2d"),a.x>b.x&&a.y>b.y)c={x:0,y:0},d={x:this.originvalue.x1-e,y:this.originvalue.y1-f},this._reverse_drawing_line(m,i,a,b,h,g,c,d);else if(a.x>b.x)c={x:0,y:f-this.originvalue.y1},d={x:this.originvalue.x1-e,y:0},this._reverse_drawing_line(m,i,a,b,h,g,c,d);else if(a.y>b.y)c={x:0,y:this.originvalue.y1-f},d={x:e-this.originvalue.x1,y:0},this._reverse_drawing_line(m,i,a,b,h,g,c,d);else switch(k=this._arrowPoint(i.w+this.xf_prop.line_width,g,h),l=this._arrowPoint(i.w+this.xf_prop.line_width,h,g),this.xf_prop.arrow_style){case 0:this._draw_line(m,g,h,i,a,b);break;case 1:case 2:"right"===this._getarrowdirection()?(j=this._arrowPoint(i.w+this.xf_prop.line_width,h,g),this._draw_line(m,g,l,i,a,b),this._drawArrow(m,i,j,h,a,b)):(j=this._arrowPoint(i.w+this.xf_prop.line_width,g,h),this._draw_line(m,h,k,i,a,b),this._drawArrow(m,i,j,g,a,b));break;case 3:j=this._arrowPoint(i.w+this.xf_prop.line_width,h,g),this._draw_line(m,k,l,i,a,b),this._drawArrow(m,i,j,h,a,b),j=this._arrowPoint(i.w+this.xf_prop.line_width,g,h),this._drawArrow(m,i,j,g,a,b)}},XF_LINE.prototype._reverse_drawing_line=function(a,b,c,d,e,f,g,h){var i,j,k;switch(i=null,j=null,k=null,j=this._arrowPoint(b.w+this.xf_prop.line_width,g,h),k=this._arrowPoint(b.w+this.xf_prop.line_width,h,g),this.xf_prop.arrow_style){case 0:this._draw_line(a,g,h,b,c,d);break;case 1:case 2:"right"===this._getarrowdirection()?(i=this._arrowPoint(b.w+this.xf_prop.line_width,h,g),this._draw_line(a,g,k,b,c,d),this._drawArrow(a,b,i,h,c,d)):(i=this._arrowPoint(b.w+this.xf_prop.line_width,g,h),this._draw_line(a,h,j,b,c,d),this._drawArrow(a,b,i,g,c,d));break;case 3:i=this._arrowPoint(b.w+this.xf_prop.line_width,h,g),this._draw_line(a,j,k,b,c,d),this._drawArrow(a,b,i,h,c,d),i=this._arrowPoint(b.w+this.xf_prop.line_width,g,h),this._drawArrow(a,b,i,g,c,d)}},XF_LINE.prototype._getarrowdirection=function(){var a;return a="right",1==this.xf_prop.arrow_style?this.originvalue.x2>this.originvalue.x1?a="right":this.originvalue.x2<this.originvalue.x1?a="left":this.originvalue.y2>this.originvalue.y1?a="right":this.originvalue.y2<this.originvalue.y1&&(a="right"):2==this.xf_prop.arrow_style&&(this.originvalue.x2>this.originvalue.x1?a="left":this.originvalue.x2<this.originvalue.x1?a="right":this.originvalue.y2>this.originvalue.y1?a="left":this.originvalue.y2<this.originvalue.y1&&(a="left")),a},XF_LINE.prototype._drawArrow=function(a,b,c,d,e,f){var g;g=this._getAngleBetweenPoints(c,d),a.save(),e.x==f.x?a.translate(c.x+b.h+this.xf_prop.line_width,c.y):e.y==f.y?a.translate(c.x,c.y+b.h+this.xf_prop.line_width):a.translate(c.x,c.y),a.rotate(g*Math.PI/180),a.beginPath(),a.moveTo(0,0),a.lineTo(0,-b.h),a.lineTo(b.w,0),a.lineTo(0,+b.h),a.lineTo(0,0),a.strokeStyle=_xfu.rgbfunc(this.xf_prop.line_color),a.fillStyle=_xfu.rgbfunc(this.xf_prop.line_color),a.fill(),a.setLineDash([0]),a.stroke(),a.restore()},XF_LINE.prototype._arrowPoint=function(a,b,c){var d,e,f;return f=this._getAngleBetweenPoints(b,c),d=a*Math.cos(f*Math.PI/180)+b.x,e=a*Math.sin(f*Math.PI/180)+b.y,{x:d,y:e}},XF_LINE.prototype._getAngleBetweenPoints=function(a,b){var c;return c={x:b.x-a.x,y:b.y-a.y},180*Math.atan2(c.y,c.x)/Math.PI},XF_LINE.prototype.on_parent_resize=function(a,b){var c,d,e,f;0===this.xf_prop.width_unit&&0===this.xf_prop.height_unit&&0===this.xf_prop.resize_dir||(c=_xfx.resizesize(this),d=_xfx.parentsize(this),e=this.originvalue.x2,f=this.originvalue.y2,1===this.xf_prop.width_unit?(this.xf_prop.x2=c.width+this.originvalue.x1,e=this.xf_prop.x2):1!==this.xf_prop.resize_dir&&3!==this.xf_prop.resize_dir||this.xf_prop.x1!==this.xf_prop.x2&&(e=this.originvalue.x2+this._resizedirwidth(this,d.width)),1===this.xf_prop.height_unit?(this.xf_prop.y2=c.height+this.originvalue.y1,f=this.xf_prop.y2):2!==this.xf_prop.resize_dir&&3!==this.xf_prop.resize_dir||this.originvalue.y1!==this.originvalue.y2&&(f=this.originvalue.y2+this._resizedirheight(this,d.height)),this._before_drawing_arrow(e,f),this.on_object_resize(a,b))},XF_LINE.prototype._resizedirheight=function(a,b){var c;return c=_xfu["int"](b),c-a.originvalue.y2-a.originvalue.bottom},XF_LINE.prototype._resizedirwidth=function(a,b){var c;return c=_xfu["int"](b),c-a.originvalue.x2-a.originvalue.right},XF_LINE.prototype.on_object_resize=function(a){var b;b=this.xf_object.position(),this.xf_prop.x1=b.left,this.xf_prop.y1=b.top,this.xf_prop.width=this.getwidth(),this.xf_prop.height=this.getheight(),this.xf_prop.x2=this.xf_prop.x1+this.xf_prop.width,this.xf_prop.y2=this.xf_prop.y1+this.xf_prop.height},XF_LINE.prototype._size=function(a,b,c,d,e,f,g,h){var i,j,k,l;a.x==b.x&&0!=this.xf_prop.arrow_style?(i=e-d.h-this.xf_prop.line_width,j=f,k=2*d.h+2*this.xf_prop.line_width,l=h-f):a.x==b.x&&0==this.xf_prop.arrow_style?(i=e-this.xf_prop.line_width/2,j=f,l=h-f,k=this.xf_prop.line_width):a.y==b.y&&0!=this.xf_prop.arrow_style?(i=e,j=a.y-d.h-this.xf_prop.line_width,k=g-e,l=2*d.h+2*this.xf_prop.line_width):a.y==b.y&&0==this.xf_prop.arrow_style?(i=e,j=a.y-this.xf_prop.line_width/2,k=g-e,l=this.xf_prop.line_width):(i=e,j=f,k=g-e,l=h-f),this._setcanvassizepos(i,j,k,l)},XF_LINE.prototype._setcanvassizepos=function(a,b,c,d){this.xf_object.css({left:a,top:b}),this.xf_object.prop({width:c,height:d})},XF_LINE.prototype._initanchor=function(){0===this.xf_prop.position&&(0===this.xf_prop.anchor?this.xf_object.css({right:"",bottom:""}):1===this.xf_prop.anchor?this.xf_object.css({right:"",top:""}):2===this.xf_prop.anchor?this.xf_object.css({left:"",bottom:""}):3===this.xf_prop.anchor?this.xf_object.css({left:"",top:""}):4===this.xf_prop.anchor?this.xf_object.css({top:"",right:""}):5===this.xf_prop.anchor?this.xf_object.css({left:"",bottom:""}):6===this.xf_prop.anchor?this.xf_object.css({left:"",top:""}):7===this.xf_prop.anchor?this.xf_object.css({left:"",top:""}):8===this.xf_prop.anchor&&this.xf_object.css({left:"",top:""}))},XF_LINE.prototype.setlinecolor=function(a){this.xf_prop.line_color=_xfu.rgb(a),this._before_drawing_arrow(this.xf_prop.x2,this.xf_prop.y2)},XF_LINE.prototype.getlinecolor=function(){return _xfu.color(this.xf_prop.line_color)},XF_LINE.prototype.on_object_mousedown=function(a){factory.registermouseevent(this,a),0==this.xf_prop.dragable&&0==this.xf_prop.click_setfocus&&a.preventDefault()},XF_LINE.prototype.on_object_click=function(a){factory.registermouseevent(this,a),factory._fireevent({xf_component:this,event_name:"on_click",is_fire_async:!0},this)};